import"core-js/modules/es.array.find-index";import"core-js/modules/es.array.splice";import"core-js/modules/es.function.name";import"core-js/modules/es.object.get-prototype-of";import"core-js/modules/es.object.keys";import"core-js/modules/web.dom-collections.for-each";import _assertThisInitialized from"@babel/runtime/helpers/esm/assertThisInitialized";import _inheritsLoose from"@babel/runtime/helpers/esm/inheritsLoose";import _defineProperty from"@babel/runtime/helpers/esm/defineProperty";export function isPlainObject(a){if("object"!=typeof a||null===a)return!1;for(var b=a;null!==Object.getPrototypeOf(b);)b=Object.getPrototypeOf(b);return Object.getPrototypeOf(a)===proto}export var TaskCountEvent="TaskCountEvent";export var LoadingState;(function(a){a.Start="Start",a.Stop="Stop",a.Depth="Depth"})(LoadingState||(LoadingState={}));export var PEvent=/*#__PURE__*/function(){function a(a,b,c){void 0===c&&(c=!1),this.name=a,this.data=b,this.bubbling=c,_defineProperty(this,"target",null),_defineProperty(this,"currentTarget",null)}var b=a.prototype;return b.setTarget=function setTarget(a){this.target=a},b.setCurrentTarget=function setCurrentTarget(a){this.currentTarget=a},a}();export var PDispatcher=/*#__PURE__*/function(){function a(a){this.parent=a,_defineProperty(this,"storeHandlers",{})}var b=a.prototype;return b.addListener=function addListener(a,b){var c=this.storeHandlers[a];return c||(this.storeHandlers[a]=c=[]),c.push(b),this},b.removeListener=function removeListener(a,b){var c=this;if(!a)Object.keys(this.storeHandlers).forEach(function(a){delete c.storeHandlers[a]});else{var d=this.storeHandlers;if(d.propertyIsEnumerable(a)){var e=d[a];if(!b)delete d[a];else{var f=e.indexOf(b);-1<f&&e.splice(f,1),0===e.length&&delete d[a]}}}return this},b.dispatch=function dispatch(a){a.target||a.setTarget(this),a.setCurrentTarget(this);var b=this.storeHandlers[a.name];if(b)for(var c=0,d=b.length;c<d;c++)b[c](a);return this.parent&&a.bubbling&&this.parent.dispatch(a),this},b.setParent=function setParent(a){return this.parent=a,this},a}();export var TaskCounter=/*#__PURE__*/function(a){function b(b){var c;return c=a.call(this)||this,c.deferSecond=b,_defineProperty(_assertThisInitialized(c),"list",[]),_defineProperty(_assertThisInitialized(c),"ctimer",0),c}_inheritsLoose(b,a);var c=b.prototype;return c.addItem=function addItem(a,b){var c=this;return void 0===b&&(b=""),this.list.some(function(b){return b.promise===a})||(this.list.push({promise:a,note:b}),a.then(function(){return c.completeItem(a)},function(){return c.completeItem(a)}),1===this.list.length&&(this.dispatch(new PEvent(TaskCountEvent,LoadingState.Start)),this.ctimer=setTimeout(function(){c.ctimer=0,0<c.list.length&&c.dispatch(new PEvent(TaskCountEvent,LoadingState.Depth))},1e3*this.deferSecond))),a},c.completeItem=function completeItem(a){var b=this.list.findIndex(function(b){return b.promise===a});return-1<b&&(this.list.splice(b,1),0===this.list.length&&(this.ctimer&&(clearTimeout(this.ctimer),this.ctimer=0),this.dispatch(new PEvent(TaskCountEvent,LoadingState.Stop)))),this},b}(PDispatcher);
//# sourceMappingURL=sprite.js.map