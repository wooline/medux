{"version":3,"file":"index.min.js","sources":["../../src/index.ts"],"sourcesContent":["import {HistoryProxy, RouteData} from '@medux/core/types/export';\n\nimport {History} from 'history';\n\nexport {createBrowserHistory, createMemoryHistory, createHashHistory} from 'history';\n\ninterface BrowserLocation {\n  pathname: string;\n  search: string;\n  hash: string;\n  state: RouteData;\n}\n\nexport interface Location {\n  pathname: string;\n  search: string;\n  hash: string;\n}\n\nexport type RouteToLocation = (routeData: RouteData) => Location;\nexport type LocationToRoute = (location: Location) => RouteData;\n\nexport interface TransformRoute {\n  locationToRoute: LocationToRoute;\n  routeToLocation: RouteToLocation;\n}\n\nfunction isLocation(data: RouteData | Location): data is Location {\n  return !!data['pathname'];\n}\n\nexport interface HistoryActions<P = RouteData> {\n  push(data: P | Location | string): void;\n  replace(data: P | Location | string): void;\n  go(n: number): void;\n  goBack(): void;\n  goForward(): void;\n}\nclass BrowserHistoryProxy implements HistoryProxy<BrowserLocation> {\n  public initialized = true;\n  public constructor(protected history: History, protected locationToRoute: LocationToRoute) {}\n  public getLocation() {\n    return this.history.location;\n  }\n  public subscribe(listener: (location: BrowserLocation) => void) {\n    this.history.listen(listener);\n  }\n  public locationToRouteData(location: BrowserLocation) {\n    return location.state || this.locationToRoute(location);\n  }\n  public equal(a: BrowserLocation, b: BrowserLocation) {\n    return a.pathname === b.pathname && a.search === b.search && a.hash === b.hash;\n  }\n  public patch(location: BrowserLocation, routeData: RouteData): void {\n    this.history.push({...location, state: routeData});\n  }\n}\n\nclass BrowserHistoryActions implements HistoryActions {\n  public constructor(protected history: History, protected routeToLocation: RouteToLocation) {}\n  public push(data: RouteData | Location | string): void {\n    if (typeof data === 'string') {\n      this.history.push(data);\n    } else if (isLocation(data)) {\n      this.history.push({...data, state: undefined});\n    } else {\n      const location = this.routeToLocation(data as RouteData);\n      this.history.push({...location, state: data});\n    }\n  }\n  public replace(data: RouteData | Location | string): void {\n    if (typeof data === 'string') {\n      this.history.replace(data);\n    } else if (isLocation(data)) {\n      this.history.replace({...data, state: undefined});\n    } else {\n      const location = this.routeToLocation(data as RouteData);\n      this.history.replace({...location, state: data});\n    }\n  }\n  public go(n: number) {\n    this.history.go(n);\n  }\n  public goBack() {\n    this.history.goBack();\n  }\n  public goForward() {\n    this.history.goForward();\n  }\n}\n\nexport function createHistory(history: History, transformRoute: TransformRoute) {\n  const historyProxy: HistoryProxy<BrowserLocation> = new BrowserHistoryProxy(history, transformRoute.locationToRoute);\n  const historyActions: HistoryActions = new BrowserHistoryActions(history, transformRoute.routeToLocation);\n  return {\n    historyProxy,\n    historyActions,\n  };\n}\n"],"names":["isLocation","data","BrowserHistoryProxy","history","locationToRoute","getLocation","this","location","subscribe","listener","listen","locationToRouteData","state","equal","a","b","pathname","search","hash","patch","routeData","push","BrowserHistoryActions","routeToLocation","undefined","replace","go","n","goBack","goForward","transformRoute","historyProxy","historyActions"],"mappings":"qMA2BA,SAASA,EAAWC,WACTA,EAAI,aAUTC,wBAEyBC,EAA4BC,QAA5BD,QAAAA,OAA4BC,gBAAAA,wBADpC,8BAEdC,YAAP,kBACSC,KAAKH,QAAQI,YAEfC,UAAP,SAAiBC,QACVN,QAAQO,OAAOD,MAEfE,oBAAP,SAA2BJ,UAClBA,EAASK,OAASN,KAAKF,gBAAgBG,MAEzCM,MAAP,SAAaC,EAAoBC,UACxBD,EAAEE,WAAaD,EAAEC,UAAYF,EAAEG,SAAWF,EAAEE,QAAUH,EAAEI,OAASH,EAAEG,QAErEC,MAAP,SAAaZ,EAA2Ba,QACjCjB,QAAQkB,sBAASd,GAAUK,MAAOQ,WAIrCE,wBACyBnB,EAA4BoB,QAA5BpB,QAAAA,OAA4BoB,gBAAAA,6BAClDF,KAAP,SAAYpB,MACU,iBAATA,OACJE,QAAQkB,KAAKpB,QACb,GAAID,EAAWC,QACfE,QAAQkB,sBAASpB,GAAMW,WAAOY,SAC9B,KACCjB,EAAWD,KAAKiB,gBAAgBtB,QACjCE,QAAQkB,sBAASd,GAAUK,MAAOX,SAGpCwB,QAAP,SAAexB,MACO,iBAATA,OACJE,QAAQsB,QAAQxB,QAChB,GAAID,EAAWC,QACfE,QAAQsB,yBAAYxB,GAAMW,WAAOY,SACjC,KACCjB,EAAWD,KAAKiB,gBAAgBtB,QACjCE,QAAQsB,yBAAYlB,GAAUK,MAAOX,SAGvCyB,GAAP,SAAUC,QACHxB,QAAQuB,GAAGC,MAEXC,OAAP,gBACOzB,QAAQyB,YAERC,UAAP,gBACO1B,QAAQ0B,4XAIV,SAAuB1B,EAAkB2B,SAGvC,CACLC,aAHkD,IAAI7B,EAAoBC,EAAS2B,EAAe1B,iBAIlG4B,eAHqC,IAAIV,EAAsBnB,EAAS2B,EAAeP"}