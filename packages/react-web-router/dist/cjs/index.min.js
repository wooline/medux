"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=require("history"),r=e(require("@babel/runtime/helpers/esm/assertThisInitialized")),n=e(require("@babel/runtime/helpers/esm/inheritsLoose")),i=e(require("@babel/runtime/helpers/esm/defineProperty")),o=require("redux"),a=e(require("@babel/runtime/regenerator")),u=e(require("@babel/runtime/helpers/esm/decorate")),s=e(require("react")),c=require("react-router-dom"),f=require("react-redux"),d=require("react-dom/server"),l=e(require("react-dom"));function p(e,t){void 0===t&&(t={});for(var r=function(e){for(var t=[],r=0;r<e.length;){var n=e[r];if("*"!==n&&"+"!==n&&"?"!==n)if("\\"!==n)if("{"!==n)if("}"!==n)if(":"!==n)if("("!==n)t.push({type:"CHAR",index:r,value:e[r++]});else{var i=1,o="",a=r+1;if("?"===e[a])throw new TypeError('Pattern cannot start with "?" at '+a);for(;a<e.length;)if("\\"!==e[a]){if(")"===e[a]){if(0===--i){a++;break}}else if("("===e[a]&&(i++,"?"!==e[a+1]))throw new TypeError("Capturing groups are not allowed at "+a);o+=e[a++]}else o+=e[a++]+e[a++];if(i)throw new TypeError("Unbalanced pattern at "+r);if(!o)throw new TypeError("Missing pattern at "+r);t.push({type:"PATTERN",index:r,value:o}),r=a}else{for(var u="",s=r+1;s<e.length;){var c=e.charCodeAt(s);if(!(c>=48&&c<=57||c>=65&&c<=90||c>=97&&c<=122||95===c||46===c))break;u+=e[s++]}if(!u)throw new TypeError("Missing parameter name at "+r);t.push({type:"NAME",index:r,value:u}),r=s}else t.push({type:"CLOSE",index:r,value:e[r++]});else t.push({type:"OPEN",index:r,value:e[r++]});else t.push({type:"ESCAPED_CHAR",index:r++,value:e[r++]});else t.push({type:"MODIFIER",index:r,value:e[r++]})}return t.push({type:"END",index:r,value:""}),t}(e),n=t.prefixes,i=void 0===n?"./":n,o="[^"+v(t.delimiter||"/#?")+"]+?",a=[],u=0,s=0,c="",f=function(e){if(s<r.length&&r[s].type===e)return r[s++].value},d=function(e){var t=f(e);if(void 0!==t)return t;var n=r[s],i=n.type,o=n.index;throw new TypeError("Unexpected "+i+" at "+o+", expected "+e)},l=function(){for(var e,t="";e=f("CHAR")||f("ESCAPED_CHAR");)t+=e;return t};s<r.length;){var p=f("CHAR"),h=f("NAME"),y=f("PATTERN");if(h||y){var m=p||"";-1===i.indexOf(m)&&(c+=m,m=""),c&&(a.push(c),c=""),a.push({name:h||u++,prefix:m,suffix:"",pattern:y||o,modifier:f("MODIFIER")||""})}else{var g=p||f("ESCAPED_CHAR");if(g)c+=g;else if(c&&(a.push(c),c=""),f("OPEN")){var _=l(),S=f("NAME")||"",E=f("PATTERN")||"",x=l();d("CLOSE"),a.push({name:S||(E?u++:""),pattern:S&&!E?o:E,prefix:_,suffix:x,modifier:f("MODIFIER")||""})}else d("END")}}return a}function h(e,t){return function(e,t){void 0===t&&(t={});var r=y(t),n=t,i=n.encode,o=void 0===i?function(e){return e}:i,a=n.validate,u=void 0===a||a,s=e.map((function(e){if("object"==typeof e)return new RegExp("^(?:"+e.pattern+")$",r)}));return function(t){for(var r="",n=0;n<e.length;n++){var i=e[n];if("string"!=typeof i){var a=t?t[i.name]:void 0,c="?"===i.modifier||"*"===i.modifier,f="*"===i.modifier||"+"===i.modifier;if(Array.isArray(a)){if(!f)throw new TypeError('Expected "'+i.name+'" to not repeat, but got an array');if(0===a.length){if(c)continue;throw new TypeError('Expected "'+i.name+'" to not be empty')}for(var d=0;d<a.length;d++){var l=o(a[d],i);if(u&&!s[n].test(l))throw new TypeError('Expected all "'+i.name+'" to match "'+i.pattern+'", but got "'+l+'"');r+=i.prefix+l+i.suffix}}else if("string"!=typeof a&&"number"!=typeof a){if(!c){var p=f?"an array":"a string";throw new TypeError('Expected "'+i.name+'" to be '+p)}}else{var h=o(String(a),i);if(u&&!s[n].test(h))throw new TypeError('Expected "'+i.name+'" to match "'+i.pattern+'", but got "'+h+'"');r+=i.prefix+h+i.suffix}}else r+=i}return r}}(p(e,t),t)}function v(e){return e.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function y(e){return e&&e.sensitive?"":"i"}function m(e,t,r){return function(e,t,r){void 0===r&&(r={});var n=r,i=n.strict,o=void 0!==i&&i,a=n.start,u=void 0===a||a,s=n.end,c=void 0===s||s,f=n.encode,d=void 0===f?function(e){return e}:f,l="["+v(r.endsWith||"")+"]|$",p="["+v(r.delimiter||"/#?")+"]",h=u?"^":"",m=e,g=Array.isArray(m),_=0;for(m=g?m:m[Symbol.iterator]();;){var S;if(g){if(_>=m.length)break;S=m[_++]}else{if((_=m.next()).done)break;S=_.value}var E=S;if("string"==typeof E)h+=v(d(E));else{var x=v(d(E.prefix)),b=v(d(E.suffix));if(E.pattern)if(t&&t.push(E),x||b)if("+"===E.modifier||"*"===E.modifier){var w="*"===E.modifier?"?":"";h+="(?:"+x+"((?:"+E.pattern+")(?:"+b+x+"(?:"+E.pattern+"))*)"+b+")"+w}else h+="(?:"+x+"("+E.pattern+")"+b+")"+E.modifier;else h+="("+E.pattern+")"+E.modifier;else h+="(?:"+x+b+")"+E.modifier}}if(c)o||(h+=p+"?"),h+=r.endsWith?"(?="+l+")":"$";else{var k=e[e.length-1],P="string"==typeof k?p.indexOf(k[k.length-1])>-1:void 0===k;o||(h+="(?:"+p+"(?="+l+"))?"),P||(h+="(?="+p+"|"+l+")")}return new RegExp(h,y(r))}(p(e,r),t,r)}function g(e,t,r){return e instanceof RegExp?function(e,t){if(!t)return e;var r=e.source.match(/\((?!\?)/g);if(r)for(var n=0;n<r.length;n++)t.push({name:n,prefix:"",suffix:"",modifier:"",pattern:""});return e}(e,t):Array.isArray(e)?function(e,t,r){var n=e.map((function(e){return g(e,t,r).source}));return new RegExp("(?:"+n.join("|")+")",y(r))}(e,t,r):m(e,t,r)}var _={},S=0;function E(e,t){void 0===t&&(t={end:!1,strict:!1,sensitive:!1});var r=""+t.end+t.strict+t.sensitive,n=_[r]||(_[r]={});if(n[e])return n[e];var i=[],o={regexp:g(e,i,t),keys:i};return S<1e4&&(n[e]=o,S++),o}function x(e,t){void 0===t&&(t={}),("string"==typeof t||Array.isArray(t))&&(t={path:t});var r=t,n=r.path,i=r.exact,o=void 0!==i&&i,a=r.strict,u=void 0!==a&&a,s=r.sensitive,c=void 0!==s&&s;return[].concat(n).reduce((function(t,r){if(!r)return null;if(t)return t;if("*"===r)return{path:r,url:e,isExact:!0,params:{}};var n=E(r,{end:o,strict:u,sensitive:c}),i=n.regexp,a=n.keys,s=i.exec(e);if(!s)return null;var f=s[0],d=s.slice(1),l=e===f;return o&&!l?null:{path:r,url:"/"===r&&""===f?"/":f,isExact:l,params:a.reduce((function(e,t,r){return e[t.name]=d[r],e}),{})}}),null)}var b,w=function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e){function t(e){return e instanceof Buffer||e instanceof Date||e instanceof RegExp}function r(e){if(e instanceof Buffer){var t=Buffer.alloc?Buffer.alloc(e.length):new Buffer(e.length);return e.copy(t),t}if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp)return new RegExp(e);throw new Error("Unexpected situation")}function n(e){var i=[];return e.forEach((function(e,a){"object"==typeof e&&null!==e?Array.isArray(e)?i[a]=n(e):t(e)?i[a]=r(e):i[a]=o({},e):i[a]=e})),i}function i(e,t){return"__proto__"===t?void 0:e[t]}var o=e.exports=function(){if(arguments.length<1||"object"!=typeof arguments[0])return!1;if(arguments.length<2)return arguments[0];var e,a,u=arguments[0],s=Array.prototype.slice.call(arguments,1);return s.forEach((function(s){"object"!=typeof s||null===s||Array.isArray(s)||Object.keys(s).forEach((function(c){return a=i(u,c),(e=i(s,c))===u?void 0:"object"!=typeof e||null===e?void(u[c]=e):Array.isArray(e)?void(u[c]=n(e)):t(e)?void(u[c]=r(e)):"object"!=typeof a||null===a||Array.isArray(a)?void(u[c]=o({},e)):void(u[c]=o(a,e))}))})),u}}));(b=exports.LoadingState||(exports.LoadingState={})).Start="Start",b.Stop="Stop",b.Depth="Depth";var k=function(){function e(e,t,r){void 0===r&&(r=!1),this.name=e,this.data=t,this.bubbling=r,i(this,"target",null),i(this,"currentTarget",null)}var t=e.prototype;return t.setTarget=function(e){this.target=e},t.setCurrentTarget=function(e){this.currentTarget=e},e}(),P=function(e){function t(t){var n;return(n=e.call(this)||this).deferSecond=t,i(r(n),"list",[]),i(r(n),"ctimer",null),n}n(t,e);var o=t.prototype;return o.addItem=function(e,t){var r=this;return void 0===t&&(t=""),this.list.some((function(t){return t.promise===e}))||(this.list.push({promise:e,note:t}),e.then((function(){return r.completeItem(e)}),(function(){return r.completeItem(e)})),1===this.list.length&&(this.dispatch(new k("TaskCountEvent",exports.LoadingState.Start)),this.ctimer=setTimeout((function(){r.ctimer=null,r.list.length>0&&r.dispatch(new k("TaskCountEvent",exports.LoadingState.Depth))}),1e3*this.deferSecond))),e},o.completeItem=function(e){var t=this.list.findIndex((function(t){return t.promise===e}));return t>-1&&(this.list.splice(t,1),0===this.list.length&&(this.ctimer&&(clearTimeout(this.ctimer),this.ctimer=null),this.dispatch(new k("TaskCountEvent",exports.LoadingState.Stop)))),this},t}(function(){function e(e){this.parent=e,i(this,"storeHandlers",{})}var t=e.prototype;return t.addListener=function(e,t){var r=this.storeHandlers[e];return r||(this.storeHandlers[e]=r=[]),r.push(t),this},t.removeListener=function(e,t){var r=this;if(e){var n=this.storeHandlers;if(n.propertyIsEnumerable(e)){var i=n[e];if(t){var o=i.indexOf(t);o>-1&&i.splice(o,1),0===i.length&&delete n[e]}else delete n[e]}}else Object.keys(this.storeHandlers).forEach((function(e){delete r.storeHandlers[e]}));return this},t.dispatch=function(e){e.target||e.setTarget(this),e.setCurrentTarget(this);var t=this.storeHandlers[e.name];if(t)for(var r=0,n=t.length;r<n;r++)t[r](e);return this.parent&&e.bubbling&&this.parent.dispatch(e),this},t.setParent=function(e){return this.parent=e,this},e}()),R={};var O={NSP:"/",VSP:".",MSP:","},T={isServer:"undefined"!=typeof global&&"undefined"==typeof window,isDev:"production"!==process.env.NODE_ENV,actionCreatorMap:null,clientStore:null,appModuleName:null,moduleGetter:null},j={MLoading:"Loading",MInit:"Init",MRouteParams:"RouteParams",Error:"medux"+O.NSP+"Error",RouteChange:"medux"+O.NSP+"RouteChange"},M=T.isServer?void 0:"undefined"==typeof window?global:window;function N(e){return"object"==typeof e&&"function"==typeof e.then}function A(e,t,r){t||r||(t=e.key,r=e.descriptor);var n=r.value;return n.__actionName__=t,n.__isReducer__=!0,r.enumerable=!0,e.descriptor===r?e:r}function C(e){return"object"!=typeof e||void 0===e.meduxProcessed?void 0:!!e.meduxProcessed}function D(e,t,r,n){if(n[e]||(n[e]={}),n[e][r])throw new Error("Action duplicate or conflict : "+e+".");n[e][r]=t}function L(e,t){var r=T.actionCreatorMap[e];r[t]||(r[t]=function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return{type:e+O.NSP+t,payload:n}})}function I(e){return{type:j.Error,payload:[e]}}function H(e,t,r){if(!t._medux_.injectedModules[e]){var n=T.moduleGetter,i=n[e]();return"function"==typeof i.then?i.then((function(i){return n[e]=function(){return i},i.default.model(t,r)})):i.default.model(t,r)}}function q(e){return Array.isArray(e.payload)?e.payload:[]}function B(e,t){var r=!1,n=function(n){if(r)r=!1;else{var i=e.getState().route;if(i&&t.equal(i.location,n))return;var o=t.locationToRouteData(n);e.dispatch(function(e){return{type:j.RouteChange,payload:[e]}}({location:n,data:o}))}};t.subscribe(n),e.subscribe((function(){if(t.initialized){var n=e.getState().route;t.equal(n.location,t.getLocation())||(r=!0,t.patch(n.location,n.data))}})),t.initialized&&n(t.getLocation())}function K(e,t,r,n,i){if(void 0===t&&(t={}),void 0===r&&(r={}),void 0===n&&(n=[]),void 0===i&&(i=[]),r.route)throw new Error("the reducer name 'route' is not allowed");r.route=function(e,t){if(t.type===j.RouteChange){var r=q(t)[0];return e?Object.assign({},e,{},r):r}return e};var a=o.applyMiddleware.apply(void 0,[function(){return function(e){return function(t){var r=t.type.split(O.NSP),n=r[0],i=r[1];if(n&&i&&T.moduleGetter[n]){var o=H(n,s,void 0);if(N(o))return o.then((function(){return e(t)}))}return e(t)}}}].concat(n,[function(e){var t=e.dispatch;return function(e){return function(r){if(T.isServer&&r.type.split(O.NSP)[1]===j.MLoading)return r;var n=s._medux_;n.beforeState=n.prevState;var i=e(r);if(i.type===j.RouteChange){var o=n.prevState.route.data.params;Object.keys(o).forEach((function(e){var r=o[e];r&&Object.keys(r).length>0&&n.injectedModules[e]&&t(function(e,t){return{type:""+e+O.NSP+j.MRouteParams,payload:[t]}}(e,r))}))}var a=n.effectMap[i.type]||{},u=n.effectMap[i.type.replace(new RegExp("[^"+O.NSP+"]+"),"*")]||{},c=Object.assign({},a,{},u),f=Object.keys(c);if(f.length>0){var d=[],l=i.priority?[].concat(i.priority):[];f.forEach((function(e){var t=c[e];e===T.appModuleName?d.unshift(e):d.push(e),t.__isHandler__||l.unshift(e)})),d.unshift.apply(d,l);var p={},h=[];if(d.forEach((function(e){if(!p[e]){p[e]=!0;var r=c[e],n=r.apply(void 0,q(i)),o=r.__decorators__;if(o){var a=[];o.forEach((function(t,r){a[r]=t[0](i,e,n)})),r.__decoratorResults__=a}var u=n.then((function(e){if(o){var t=r.__decoratorResults__||[];o.forEach((function(r,n){r[1]&&r[1]("Resolved",t[n],e)})),r.__decoratorResults__=void 0}return e}),(function(e){if(o){var n=r.__decoratorResults__||[];o.forEach((function(t,r){t[1]&&t[1]("Rejected",n[r],e)})),r.__decoratorResults__=void 0}if(i.type===j.Error)throw void 0===C(e)&&(e=function(e,t){return"object"==typeof e?(e.meduxProcessed=t,e):{meduxProcessed:t,error:e}}(e,!0)),e;if(C(e))throw e;return t(I(e))}));h.push(u)}})),h.length)return Promise.all(h)}return i}}}])),u=[].concat(i,[a,function(e){return function(){var t=e.apply(void 0,arguments),r=t;return r._medux_={beforeState:{},prevState:{},currentState:{},reducerMap:{},effectMap:{},injectedModules:{},currentViews:{}},t}}]);T.isDev&&M&&M.__REDUX_DEVTOOLS_EXTENSION__&&u.push(M.__REDUX_DEVTOOLS_EXTENSION__(M.__REDUX_DEVTOOLS_EXTENSION__OPTIONS));var s=o.createStore((function(e,t){if(!s)return e;var n=s._medux_;n.prevState=e;var i=Object.assign({},e);n.currentState=i,Object.keys(r).forEach((function(e){i[e]=r[e](i[e],t)}));var o=n.reducerMap[t.type]||{},a=n.reducerMap[t.type.replace(new RegExp("[^"+O.NSP+"]+"),"*")]||{},u=Object.assign({},o,{},a),c=Object.keys(u);if(c.length>0){var f=[],d=t.priority?[].concat(t.priority):[];c.forEach((function(e){var t=u[e];e===T.appModuleName?f.unshift(e):f.push(e),t.__isHandler__||d.unshift(e)})),f.unshift.apply(f,d);var l={};f.forEach((function(e){if(!l[e]){l[e]=!0;var r=u[e];i[e]=r.apply(void 0,q(t))}}))}var p=Object.keys(e).length!==Object.keys(i).length||Object.keys(e).some((function(t){return e[t]!==i[t]}));return n.prevState=p?i:e,n.prevState}),t,o.compose.apply(void 0,u));return B(s,e),T.clientStore=s,s}var V=u(null,(function(e){return{F:function(t,r){this.moduleName=t,this.store=r,e(this)},d:[{kind:"field",key:"actions",value:function(){return null}},{kind:"get",key:"state",value:function(){return this.getState()}},{kind:"method",key:"getState",value:function(){return this.store._medux_.prevState[this.moduleName]}},{kind:"get",key:"rootState",value:function(){return this.getRootState()}},{kind:"method",key:"getRootState",value:function(){return this.store._medux_.prevState}},{kind:"get",key:"currentState",value:function(){return this.getCurrentState()}},{kind:"method",key:"getCurrentState",value:function(){return this.store._medux_.currentState[this.moduleName]}},{kind:"get",key:"currentRootState",value:function(){return this.getCurrentRootState()}},{kind:"method",key:"getCurrentRootState",value:function(){return this.store._medux_.currentState}},{kind:"get",key:"beforeState",value:function(){return this.getBeforeState()}},{kind:"method",key:"getBeforeState",value:function(){return this.store._medux_.beforeState[this.moduleName]}},{kind:"get",key:"beforeRootState",value:function(){return this.getBeforeRootState()}},{kind:"method",key:"getBeforeRootState",value:function(){return this.store._medux_.beforeState}},{kind:"method",key:"dispatch",value:function(e){return this.store.dispatch(e)}},{kind:"method",key:"callThisAction",value:function(e){for(var t=T.actionCreatorMap[this.moduleName],r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return t[e.__actionName__].apply(t,n)}},{kind:"method",key:"updateState",value:function(e){this.dispatch(this.callThisAction(this.Update,Object.assign({},this.getState(),{},e)))}},{kind:"method",key:"loadModel",value:function(e,t){return H(e,this.store,t)}},{kind:"method",decorators:[A],key:"Init",value:function(e,t,r){return Object.assign({},e,{routeParams:t||e.routeParams},r)}},{kind:"method",decorators:[A],key:"Update",value:function(e){return e}},{kind:"method",decorators:[A],key:"RouteParams",value:function(e){var t=this.getState();return Object.assign({},t,{routeParams:e})}},{kind:"method",decorators:[A],key:"Loading",value:function(e){var t=this.getState();return Object.assign({},t,{loading:Object.assign({},t.loading,{},e)})}}]}}));function U(e){return"function"==typeof e.then}function F(e,t){var r=e.map((function(e){var r=function(e,t){var r=t[e]();return U(r)?r.then((function(r){return t[e]=function(){return r},r})):r}(e,t);return U(r)?r:Promise.resolve(r)}));return Promise.all(r)}var X={escape:!0,dateParse:!0,splitKey:"q",defaultRouteParams:{}};var $=/^\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d(\.\d+)?(Z|[+-][01]\d:[0-5]\d)$/;function G(e,t){return"string"==typeof t&&$.test(t)?new Date(t):t}function z(e){for(var t=[""],r=0,n=e.length;r<n;r++)t.push(e[r]||"");return t.join("&"+X.splitKey+"=")}function W(e){if("object"!=typeof e)return"";var t=JSON.stringify(e);return"{}"===t?"":X.escape?escape(t):t}function J(e){var t=new RegExp("[&?#]"+X.splitKey+"=[^&]*","g"),r=e.match(t),n=[];return r&&(n=r.map((function(e){return function(e){if(!e)return{};X.escape&&(e=unescape(e));try{return JSON.parse(e,X.dateParse?G:void 0)}catch(e){return{}}}(e.split("=")[1])}))),n}function Z(e){var t={};for(var r in e)e.hasOwnProperty(r)&&function(){var n=e[r],i=r.split(".");i.length>1?i.reduce((function(e,t,r,i){return r===i.length-1?e[t]=n:e[t]={},e[t]}),t):t[r]=n}();return t}function Q(e,t,r){t[0]||(t[0]={}),r&&(t[0]=w({},r,t[0]));var n=t[0],i=e.reduce((function(e,t){var r=t.split(O.VSP),i=r[0],o=r[1];return o&&(e[i]||(e[i]={}),e[i][o]=!0,n[i]||(n[i]={})),e}),{});Object.keys(n).forEach((function(e){n[e]=w({},X.defaultRouteParams[e],n[e])}));var o=w.apply(void 0,[{}].concat(t));return Object.keys(o).forEach((function(e){n[e]||(o[e]=w({},X.defaultRouteParams[e],o[e]))})),{views:i,paths:e,params:o,stackParams:t}}function Y(e){var t=function e(t,r,n,i){for(var o in void 0===r&&(r=""),void 0===n&&(n={}),void 0===i&&(i={}),t)if(t.hasOwnProperty(o)){if(!i[o]){var a=E(o,{end:!0,strict:!1,sensitive:!1}).keys;i[o]=a.reduce((function(e,t){return e.push(t.name),e}),[])}var u=t[o],s="string"==typeof u?[u,null]:u,c=s[0],f=s[1],d=r+"/"+c;n[d]=o,f&&e(f,d,n,i)}return{viewToRule:n,ruleToKeys:i}}(e),r=t.viewToRule,n=t.ruleToKeys;return{locationToRoute:function(t){var r=[],n={};!function e(t,r,n,i){for(var o in r)if(r.hasOwnProperty(o)){var a=r[o],u="string"==typeof a?[a,null]:a,s=u[0],c=u[1],f=x(t,{path:o,exact:!c});if(f){n.push(s);var d=s.split(O.VSP)[0],l=f.params;return l&&Object.keys(l).length>0&&(i[d]=Object.assign({},i[d],{},Z(l))),void(c&&e(t,c,n,i))}}}(t.pathname,e,r,n);var i=J(t.search);return J(t.hash).forEach((function(e,t){e&&(i[t]||(i[t]={}),w(i[t],e))})),Q(r,i,n)},routeToLocation:function(e){var t,i=e.views,o=e.paths,a=e.params,u=e.stackParams,s=u[0],c="";o.length>0?(t=w({},s),o.reduce((function(e,i,u){var s=e+"/"+i,f=r[s],d=i.split(O.VSP)[0];if(u===o.length-1){var l=function(e){if(_[e])return _[e];var t=h(e);return S<1e4&&(_[e]=t,S++),t}(f),p=(n[f]||[]).reduce((function(e,t){if("string"==typeof t){var r=t.split(".");if(r.length)return e[t]=r.reduce((function(e,t){return e[t]}),a[d]),e}return e[t]=a[d][t],e}),{});c=l(p)}return(n[f]||[]).forEach((function(e){if("string"==typeof e){var r=e.split(".");if(r.length)return void r.reduce((function(e,t,n){return n===r.length-1&&delete e[t],e[t]||{}}),t[d]||{})}t[d]&&delete t[d][e]})),s}),"")):t=s;var f=[].concat(u);f[0]=function e(t,r,n,i){var o={};if(Object.keys(t).forEach((function(n){var a=t[n],u=r[n];a!==u&&(typeof a!=typeof u||"object"!=typeof a||Array.isArray(a)||(a=e(a,u,!!i&&!i[n])),void 0!==a&&(o[n]=a))})),0!==Object.keys(o).length||n)return o}(t,X.defaultRouteParams,!1,i);var d=[],l=[];return f.forEach((function(e,t){var r=function(e){var t={},r={},n=function(n){if(e[n]&&e.hasOwnProperty(n)){var i=e[n],o=Object.keys(i);o.length>0?o.forEach((function(e){e.startsWith("_")?(r[n]||(r[n]={}),r[n][e]=i[e]):(t[n]||(t[n]={}),t[n][e]=i[e])})):t[n]={}}};for(var i in e)n(i);return{search:W(t),hash:W(r)}}(e),n=r.search,i=r.hash;n&&(d[t]=n),i&&(l[t]=i)})),{pathname:c,search:"?"+z(d).substr(1),hash:"#"+z(l).substr(1)}}}}function ee(e){var t=e.extend||{views:{},paths:[],stackParams:[],params:{}},r=[].concat(t.stackParams);return e.params&&(r[0]=w({},r[0],e.params)),Q(e.paths||t.paths,r)}function te(e){return"string"!=typeof e&&!e.pathname}function re(e,t,r,n,i){return function(e,t,r,n,i){void 0===i&&(i={}),T.appModuleName=r;var o=i.ssrInitStoreKey||"meduxInitStore",a={};(i.initData||M[o])&&(a=Object.assign({},M[o],{},i.initData));var u=K(n,a,i.reducers,i.middlewares,i.enhancers),s=u,c=[r];return a&&c.push.apply(c,Object.keys(a).filter((function(e){return e!==r&&a[e].isModule}))),F(c,t).then((function(t){var r=t[0],n=r.default.model(u,void 0);return e(s,r.default.model,r.default.views,o),N(n)?n.then((function(){return s})):s}))}((function(t,r,n,i){e((function(e){return s.createElement(f.Provider,{store:t},e.children)}),n.Main,i)}),t,r,n,i)}function ne(e,t,r,n,i){return void 0===i&&(i={}),function(e,t,r,n,i){var o,u,s,c,f,d,l,p,h,v,y;return a.async((function(m){for(;;)switch(m.prev=m.next){case 0:void 0===i&&(i={}),T.appModuleName=r,o=i.ssrInitStoreKey||"meduxInitStore",u=K(n,i.initData,i.reducers,i.middlewares,i.enhancers),s=u.getState(),0===(c=s.route.data.paths).length&&c.push(r),f=void 0,d={},l=0,p=c.length;case 10:if(!(l<p)){m.next=21;break}if(h=c[l].split(O.VSP),v=h[0],d[v]){m.next=18;break}return d[v]=!0,y=t[v](),m.next=17,a.awrap(y.default.model(u,void 0));case 17:0===l&&(f=y);case 18:l++,m.next=10;break;case 21:return m.abrupt("return",e(u,f.default.model,f.default.views,o));case 22:case"end":return m.stop()}}))}((function(t,r,n,i){var o=t.getState();return{store:t,ssrInitStoreKey:i,data:o,html:e((function(e){return s.createElement(f.Provider,{store:t},e.children)}),n.Main)}}),t,r,n,i)}var ie=function(e,t,r,n){var i=function(n,i){if(!n._medux_.injectedModules[e]){n._medux_.injectedModules[e]=!0;var o=n.getState()[e],a=new r(e,n),u=function(e,t,r){for(var n in r)"function"==typeof r[n]&&function(){var i,o,a,u=r[n];(u.__isReducer__||u.__isEffect__)&&(o=r,a=(i=u).bind(o),Object.keys(i).forEach((function(e){a[e]=i[e]})),u=a,n.split(O.MSP).forEach((function(r){(r=r.trim().replace(new RegExp("^this["+O.NSP+"]"),""+t+O.NSP)).split(O.NSP)[1]?(u.__isHandler__=!0,D(r,u,t,u.__isEffect__?e._medux_.effectMap:e._medux_.reducerMap)):(u.__isHandler__=!1,D(t+O.NSP+r,u,t,u.__isEffect__?e._medux_.effectMap:e._medux_.reducerMap),L(t,r))})))}();return T.actionCreatorMap[t]}(n,e,a);if(a.actions=u,!o){var s=n._medux_.prevState.route.data.params;t.isModule=!0;var c=u.Init(t,s[e],i);return n.dispatch(c)}}};i.moduleName=e,i.initState=t;return{moduleName:e,model:i,views:n,actions:{}}};function oe(e){return!!e.pathname}var ae=function(){function e(e,t){this.history=e,this.locationToRoute=t,i(this,"initialized",!0)}var t=e.prototype;return t.getLocation=function(){return this.history.location},t.subscribe=function(e){this.history.listen(e)},t.locationToRouteData=function(e){return e.state||this.locationToRoute(e)},t.equal=function(e,t){return e.pathname===t.pathname&&e.search===t.search&&e.hash===t.hash},t.patch=function(e,t){this.history.push(Object.assign({},e,{state:t}))},e}(),ue=function(){function e(e,t){this.history=e,this.routeToLocation=t}var t=e.prototype;return t.push=function(e){if("string"==typeof e)this.history.push(e);else if(oe(e))this.history.push(Object.assign({},e,{state:void 0}));else{var t=this.routeToLocation(e);this.history.push(Object.assign({},t,{state:e}))}},t.replace=function(e){if("string"==typeof e)this.history.replace(e);else if(oe(e))this.history.replace(Object.assign({},e,{state:void 0}));else{var t=this.routeToLocation(e);this.history.replace(Object.assign({},t,{state:e}))}},t.go=function(e){this.history.go(e)},t.goBack=function(){this.history.goBack()},t.goForward=function(){this.history.goForward()},e}();function se(e,t){return{historyProxy:new ae(e,t.locationToRoute),historyActions:new ue(e,t.routeToLocation)}}var ce=void 0,fe=void 0;exports.ActionTypes=j,exports.BaseModelHandlers=V,exports.buildApp=function(e,t,r,n,i,o){void 0===i&&(i={}),void 0===o&&(o="root"),fe||(fe=Y(n));var a=se(r,fe),u=a.historyProxy;return ce=a.historyActions,re((function(e,t,n){var i=c.withRouter(t),a=s.createElement(e,null,s.createElement(c.Router,{history:r},s.createElement(i,null)));"function"==typeof o?o(a):(window[n]?l.hydrate:l.render)(a,"string"==typeof o?document.getElementById(o):o)}),e,t,u,i)},exports.buildSSR=function(e,r,n,i,o,a){void 0===o&&(o={}),void 0===a&&(a=!1),fe||(fe=Y(i));var u=se({listen:function(){},location:t.createLocation(n)},fe),f=u.historyProxy;ce=u.historyActions;var l=a?d.renderToNodeStream:d.renderToString;return ne((function(e,t){return l(s.createElement(e,null,s.createElement(c.StaticRouter,{location:n},s.createElement(t,null))))}),e,r,f,o)},exports.delayPromise=function(e){return function(t,r,n){r||n||(r=t.key,n=t.descriptor);var i=n.value;n.value=function(){for(var r=new Promise((function(t){setTimeout((function(){t(!0)}),1e3*e)})),n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return Promise.all([r,i.apply(t,o)]).then((function(e){return e[1]}))}}},exports.effect=function(e,t){return void 0===e&&(e="global",t=T.appModuleName),function(r,n,i){n||i||(n=r.key,i=r.descriptor);var o=i.value;if(o.__actionName__=n,o.__isEffect__=!0,i.enumerable=!0,e){o.__decorators__||(o.__decorators__=[]),o.__decorators__.push([function(r,n,i){T.isServer||(t||(t=n),function(e,t,r){if(void 0===t&&(t=T.appModuleName),void 0===r&&(r="global"),T.isServer)return e;var n=t+O.NSP+r;R[n]||(R[n]=new P(2),R[n].addListener("TaskCountEvent",(function(e){var n=T.clientStore;if(n){var i,o=(0,T.actionCreatorMap[t][j.MLoading])(((i={})[r]=e.data,i));n.dispatch(o)}}))),R[n].addItem(e)}(i,t,e))},null])}return r.descriptor===i?r:i}},exports.errorAction=I,exports.exportActions=function(e){return T.moduleGetter=e,T.actionCreatorMap=Object.keys(e).reduce((function(e,t){return e[t]="undefined"==typeof Proxy?{}:new Proxy({},{get:function(e,r){return function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return{type:t+O.NSP+r,payload:n}}},set:function(){return!0}}),e}),{}),T.actionCreatorMap},exports.exportModule=ie,exports.getBrowserHistory=function(){return{historyActions:(t=function(){return ce},{push:function(e){var r=e;te(e)&&(r=ee(e)),t().push(r)},replace:function(e){var r=e;te(e)&&(r=ee(e)),t().replace(r)},go:function(e){t().go(e)},goBack:function(){t().goBack()},goForward:function(){t().goForward()}}),toUrl:(e=function(){return fe},function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(1===r.length){var i=e().routeToLocation(ee(r[0]));r=[i.pathname,i.search,i.hash]}var o=r,a=o[0],u=o[1],s=o[2],c=a;return u&&(c+=u),s&&(c+=s),c})};var e,t},exports.loadView=function(e,t,o,a){return function(u){function c(n,a){var s;s=u.call(this,n,a)||this,i(r(s),"state",{Component:null});var f=function(e,t,r){var n=T.moduleGetter,i=n[e]();if(U(i))return i.then((function(i){n[e]=function(){return i};var o=i.default.views[t];if(T.isServer)return o;var a=i.default.model(T.clientStore,r);return N(a)?a.then((function(){return o})):o}));var o=i.default.views[t];if(T.isServer)return o;var a=i.default.model(T.clientStore,r);return N(a)?a.then((function(){return o})):o}(e,t,o);return"function"==typeof f.then?f.then((function(e){Object.keys(c).forEach((function(t){return e[t]=c[t]})),Object.keys(e).forEach((function(t){return c[t]=e[t]})),s.setState({Component:e})})):(Object.keys(c).forEach((function(e){return f[e]=c[e]})),Object.keys(f).forEach((function(e){return c[e]=f[e]})),s.state={Component:f}),s}return n(c,u),c.prototype.render=function(){var e=this.state.Component;return e?s.createElement(e,this.props):a?s.createElement(a,this.props):null},c}(s.Component)},exports.reducer=A,exports.setRouteConfig=function(e){void 0!==e.escape&&(X.escape=e.escape),void 0!==e.dateParse&&(X.dateParse=e.dateParse),e.splitKey&&(X.splitKey=e.splitKey),e.defaultRouteParams&&(X.defaultRouteParams=e.defaultRouteParams)};
//# sourceMappingURL=index.min.js.map
